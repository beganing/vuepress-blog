---
title: 3. 包装类型
date: 2025/02.21
tags:
  - JavaScript
categories:
  - 前端
---

## 经典真题

- 是否了解 _JavaScript_ 中的包装类型？

## 包装类型

在 _JS_ 中，基本类型和引用类型其中一个很明显的区别是：引用类型有自己的内置方法，也可以自定义其他方法来操作数据；而基本类型不能像引用类型那样有自己的内置方法对数据进行更多的操作。

其实，对于部分基础数据类型确实不能使用方法。但是有 _3_ 个是 _ES_ 提供了对应的特殊引用类型（包装类型）`Boolean`、`Number`、`String`。

包装类型和其他引用类型一样，拥有自己内置的方法可以对数据进行额外操作。如下：

```javascript
var str = 'hello';
var s2 = str.charAt(0);
console.log(s2); // h
```

上面的 `str` 是一个基本类型，但是却可以调用 `charAt()` 方法。

主要是因为在执行第二行代码时，后台会自动进行下面的步骤：

1.  自动创建 `String` 类型的实例（和基本类型的值不同，这个实例就是一个基本包装类型的**对象**）。
2.  调用实例（对象）上指定的方法。
3.  销毁这个实例。

用代码的方式解释就是如下：

```javascript
var str = 'hello';
var s2 = str.charAt(0);
{
  // 这里是后台自动完成的
  var _s2 = new String('hello'); // 1. 找到对应的包装对象类型，通过包装对象创建出一个和基本类型值相同的对象
  var s2 = _s2.charAt(0); // 2. 包装对象就可以调用对应的内置方法，并返回结果给 s2
  _str = null; // 3. 销毁这个临时创建的包装对象
}
console.log(s2); // h
console.log(str); // hello
```

综上，基本数据类型的值虽然没有方法可以调用，但是后台临时创建的**包装对象上有内置方法可以让我们调用**。因此，这样我们就可以对字符串、数值、布尔值这三种基本数据类型的数据进行更多的操作。

而什么时候后台会自动创建一个对应的基本包装类型的对象，取决于当前执行的代码是否是为了读取它的值。

每当读取一个基本类型的值，也就是当我们需要**从内存中获取到它的值**时（这个访问过程称为读取模式），这时**后台就会自动创建一个基本包装类型的对象**。例如：

```javascript
var test = 'hhh';
console.log(test); // 读取模式，后台自动创建
var test2 = test; // 赋值给其他变量，也需要读取
```

基本包装类型的对象和引用类型的对象最大的一个区别是：**对象的生存期不同，导致基本包装类型无法自定义自己的方法**。

对于引用类型的数据，在执行流离开当前作用域之前都会保存在内存中，而**对于自动创建的基本包装类型的对象，只存在于一行代码的执行瞬间，执行完毕就会立即被销毁**。如下：

```javascript
var str = 'test';
str.test = 'hhh';
console.log(str.test); //undefined
```

上面第二行代码给自动创建的 `String` 实例对象添加了 `test` 属性，虽然此刻代码执行时它是生效的，但是在这行代码执行完毕后，该 `String` 实例就会立刻被销毁，`String` 实例的 `test` 属性也就不存在了。

当执行第三行代码时，由于是读取模式，又创建了新的 `String` 实例，而这个新创建的 `String` 实例没有 `test` 属性，结果也就是 `undefined`。用代码解释如下：

```javascript
var str = 'hello';
str.number = 10; //假设我们想给字符串添加一个属性 number ，后台会有如下步骤
{
  var _str = new String('hello'); // 1 找到对应的包装对象类型，然后通过包装对象创建出一个和基本类型值相同的对象
  _str.number = 10; // 2 通过这个对象调用包装对象下的方法 但结果并没有被任何东西保存
  _str = null; // 3 这个对象又被销毁
}
console.log(str.number); // undefined  当执行到这一句的时候，因为基本类型本来没有属性，后台又会重新重复上面的步骤
{
  var str = new String('hello'); // 1 找到基本包装对象，然后又新开辟一个内存，创建一个值为 hello 对象
  str.number = undefined; // 2 因为包装对象下面没有 number 这个属性，所以又会重新添加，因为没有值，所以值是未定义;然后弹出结果
  str = null; // 3 这个对象又被销毁
}
```

所以，如何才能给基本类型添加方法或者属性呢? **可以在基本包装对象的原型上添加**，每个对象都有原型。

```javascript
var str = 'hello';

String.prototype.myTest = function () {
  console.log('This is a test');
};

str.myTest(); // 后台自动执行下面的动作
{
  var _str = new String('hello');
  _str.myTest();
  _str = null;
}
```

## 真题解答

- 是否了解 _JavaScript_ 中的包装类型？

包装对象，就是 `Number`、`String`、`Boolean` 三个原生对象的实例对象。在基础类型的数据被读取或者以对象的方式去使用时，_JavaScript_ 会创建对应基础类型的包装类型，相当于 `new` 一个实例对象，内容和基本类型一样，但是有内置的一些方法或者属性，当操作完成后，这个临时对象会被销毁。

因为有了基本包装类型，所以这些基本类型值可以当作对象来访问。

基本类型特征：

1.  每个包装类型都映射到同名的基本类型
2.  在读取模式下访问基本类型值时，就会创建对应的基本包装类型的一个对象，从而方便了数据操作
3.  操作基本类型值的语句一经执行完毕，就会立即销毁新创建的包装对象
